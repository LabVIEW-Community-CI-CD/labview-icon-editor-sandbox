{
  "version": "2.0.0",
  "inputs": [
    {
      "id": "vipArtifactPath",
      "type": "promptString",
      "description": "Path to the built .vip (file/folder/pattern)",
      "default": "builds/VI Package/"
    },
    {
      "label": "g-cli --help (dump)",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-NoProfile",
        "-File",
        "${workspaceFolder}/.github/scripts/dump-gcli-help.ps1"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "id": "minLv",
      "type": "promptString",
      "description": "Minimum LabVIEW version (major.minor)",
      "default": "21.0"
    },
    {
      "id": "repoPath",
      "type": "promptString",
      "description": "Path to the repository root",
      "default": "${workspaceFolder}"
    },
    {
      "id": "devModeBitness",
      "type": "pickString",
      "description": "Target LabVIEW bitness for dev-mode tasks",
      "options": [
        "32",
        "64"
      ],
      "default": "64"
    },
    {
      "id": "libraryPathsBitness",
      "type": "pickString",
      "description": "Bitness for reading LocalHost.LibraryPaths entries",
      "options": [
        "32",
        "64"
      ],
      "default": "64"
    },
    {
      "id": "lvlibpBitness",
      "type": "pickString",
      "description": "Bitness for building the lvlibp",
      "options": [
        "32",
        "64"
      ],
      "default": "64"
    },
    {
      "id": "semverMajor",
      "type": "promptString",
      "description": "Major version",
      "default": "0"
    },
    {
      "id": "semverMinor",
      "type": "promptString",
      "description": "Minor version",
      "default": "1"
    },
    {
      "id": "semverPatch",
      "type": "promptString",
      "description": "Patch version",
      "default": "0"
    },
    {
      "id": "buildNumber",
      "type": "promptString",
      "description": "Build number",
      "default": "1"
    },
    {
      "id": "releaseTag",
      "type": "promptString",
      "description": "Git tag to use for the draft release (use 'auto' to derive from version inputs)",
      "default": "auto"
    },
    {
      "id": "releaseTitle",
      "type": "promptString",
      "description": "Release title (use 'auto' to reuse the tag)",
      "default": "auto"
    },
    {
      "id": "releaseNotesPath",
      "type": "promptString",
      "description": "Path to the release notes markdown file to attach and use as the release body",
      "default": "Tooling/deployment/release_notes.md"
    },
    {
      "id": "releasePrerelease",
      "type": "pickString",
      "description": "Mark the draft release as a prerelease",
      "options": [
        "false",
        "true"
      ],
      "default": "false"
    },
    {
      "id": "commitHash",
      "type": "promptString",
      "description": "Git commit hash for stamping artifacts",
      "default": "manual"
    },
    {
      "id": "companyName",
      "type": "promptString",
      "description": "Company name for metadata",
      "default": "LabVIEW-Community-CI-CD"
    },
    {
      "id": "authorName",
      "type": "promptString",
      "description": "Author/Packager name for metadata",
      "default": "LabVIEW Icon Editor CI"
    }
  ],
  "tasks": [
    {
      "label": "Analyze VI Package (Pester)",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-NoProfile",
        "-File",
        "${workspaceFolder}/.github/actions/analyze-vi-package/run-local.ps1",
        "-VipArtifactPath",
        "builds/VI Package/${workspaceFolderBasename}_64bit_*",
        "-MinLabVIEW",
        "${input:minLv}"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Build VI Package (Build.ps1)",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-NoProfile",
        "-File",
        "${workspaceFolder}/.github/actions/build/Build.ps1",
        "-RepositoryPath",
        "${input:repoPath}",
        "-Major",
        "${input:semverMajor}",
        "-Minor",
        "${input:semverMinor}",
        "-Patch",
        "${input:semverPatch}",
        "-Build",
        "${input:buildNumber}",
        "-LabVIEWMinorRevision",
        "3",
        "-Commit",
        "${input:commitHash}",
        "-CompanyName",
        "${input:companyName}",
        "-AuthorName",
        "${input:authorName}"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "group": "build",
      "problemMatcher": []
    },
    {
      "label": "Build VIP (stemmed artifact naming)",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-NoProfile",
        "-File",
        "${workspaceFolder}/.github/actions/build-vip/build_vip.ps1",
        "-SupportedBitness",
        "${input:lvlibpBitness}",
        "-RepositoryPath",
        "${input:repoPath}",
        "-VIPBPath",
        ".github/actions/build-vip/NI Icon editor.vipb",
        "-Package_LabVIEW_Version",
        "$(pwsh -NoProfile -File ${workspaceFolder}/scripts/get-package-lv-version.ps1 -RepositoryPath ${workspaceFolder})",
        "-LabVIEWMinorRevision",
        "3",
        "-Major",
        "${input:semverMajor}",
        "-Minor",
        "${input:semverMinor}",
        "-Patch",
        "${input:semverPatch}",
        "-Build",
        "${input:buildNumber}",
        "-Commit",
        "${input:commitHash}",
        "-ReleaseNotesFile",
        "${workspaceFolder}/Tooling/deployment/release_notes.md",
        "-DisplayInformationJSON",
        "{}"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "group": "build",
      "problemMatcher": []
    },
    {
      "label": "Set Dev Mode (LabVIEW)",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-NoProfile",
        "-File",
        "${workspaceFolder}/.github/actions/set-development-mode/run-dev-mode.ps1",
        "-SupportedBitness",
        "${input:devModeBitness}"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Revert Dev Mode (LabVIEW)",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-NoProfile",
        "-File",
        "${workspaceFolder}/.github/actions/revert-development-mode/run-dev-mode.ps1",
        "-SupportedBitness",
        "${input:devModeBitness}"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Build lvlibp (LabVIEW)",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-NoProfile",
        "-Command",
        "& { $ver = & \"${workspaceFolder}/scripts/get-package-lv-version.ps1\" -RepositoryPath \"${workspaceFolder}\"; & \"${workspaceFolder}/.github/actions/build-lvlibp/Build_lvlibp.ps1\" -Package_LabVIEW_Version $ver -SupportedBitness \"${input:lvlibpBitness}\" -RepositoryPath \"${workspaceFolder}\" -Major 0 -Minor 0 -Patch 0 -Build 0 -Commit \"manual\" }"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Show LocalHost.LibraryPaths (LabVIEW)",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-NoProfile",
        "-File",
        "${workspaceFolder}/scripts/read-library-paths.ps1",
        "-RepositoryPath",
        "${workspaceFolder}",
        "-SupportedBitness",
        "${input:libraryPathsBitness}",
        "-FailOnMissing"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Apply VIPC (VIPM CLI troubleshoot)",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-NoProfile",
        "-Command",
        "& { $ver = & \"${workspaceFolder}/scripts/get-package-lv-version.ps1\" -RepositoryPath \"${workspaceFolder}\"; & \"${workspaceFolder}/.github/actions/apply-vipc/ApplyVIPC.ps1\" -Package_LabVIEW_Version $ver -SupportedBitness \"64\" -RepositoryPath \"${workspaceFolder}\" -VIPCPath \".github/actions/apply-vipc/runner_dependencies.vipc\" -Verbose }"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Create draft GitHub release (local artifacts)",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-NoProfile",
        "-File",
        "${workspaceFolder}/.github/scripts/create-draft-release.ps1",
        "-RepositoryPath",
        "${input:repoPath}",
        "-VipPath",
        "${input:vipArtifactPath}",
        "-ReleaseNotesPath",
        "${input:releaseNotesPath}",
        "-Tag",
        "${input:releaseTag}",
        "-Title",
        "${input:releaseTitle}",
        "-Major",
        "${input:semverMajor}",
        "-Minor",
        "${input:semverMinor}",
        "-Patch",
        "${input:semverPatch}",
        "-Build",
        "${input:buildNumber}",
        "-Prerelease",
        "${input:releasePrerelease}"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Build and Draft Release (compound)",
      "dependsOn": [
        "Build VI Package (Build.ps1)",
        "Create draft GitHub release (local artifacts)"
      ],
      "dependsOrder": "sequence",
      "group": "build",
      "problemMatcher": []
    }
  ]
}
