{
  "version": "2.0.0",
  "inputs": [
    {
      "id": "vipArtifactPath",
      "type": "promptString",
      "description": "Path to the built .vip (file/folder/pattern)",
      "default": "builds/VI Package/"
    },
    {
      "id": "minLv",
      "type": "promptString",
      "description": "Minimum LabVIEW version (major.minor)",
      "default": "21.0"
    },
    {
      "id": "repoPath",
      "type": "promptString",
      "description": "Path to the repository root",
      "default": "${workspaceFolder}"
    },
    {
      "id": "semverMajor",
      "type": "promptString",
      "description": "Major version",
      "default": "0"
    },
    {
      "id": "semverMinor",
      "type": "promptString",
      "description": "Minor version",
      "default": "0"
    },
    {
      "id": "semverPatch",
      "type": "promptString",
      "description": "Patch version",
      "default": "0"
    },
    {
      "id": "buildNumber",
      "type": "promptString",
      "description": "Build number",
      "default": "1"
    },
    {
      "id": "companyName",
      "type": "promptString",
      "description": "Company name for metadata",
      "default": "LabVIEW-Community-CI-CD"
    },
    {
      "id": "authorName",
      "type": "promptString",
      "description": "Author/Packager name for metadata",
      "default": "LabVIEW Icon Editor CI"
    }
  ],
  "tasks": [
    {
      "label": "Analyze VI Package (Pester)",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-NoProfile",
        "-File",
        "${workspaceFolder}/.github/actions/analyze-vi-package/run-local.ps1",
        "-VipArtifactPath",
        "${input:vipArtifactPath}",
        "-MinLabVIEW",
        "${input:minLv}"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Build VI Package (Build.ps1)",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-NoProfile",
        "-Command",
        "$ErrorActionPreference='Stop'; $repo=\"${input:repoPath}\"; if ([string]::IsNullOrWhiteSpace($repo)) { throw 'RepositoryPath is empty' }; $commit = git -C $repo rev-parse HEAD 2>$null; if (-not $commit) { $commit = 'manual' }; & \"${workspaceFolder}/.github/actions/build/Build.ps1\" -RepositoryPath $repo -Major ${input:semverMajor} -Minor ${input:semverMinor} -Patch ${input:semverPatch} -Build ${input:buildNumber} -LabVIEWMinorRevision 3 -Commit $commit -CompanyName \"${input:companyName}\" -AuthorName \"${input:authorName}\""
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Set Dev Mode (LabVIEW)",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-NoProfile",
        "-Command",
        "& { $ErrorActionPreference='Stop'; $repo = (git -C \"${workspaceFolder}\" rev-parse --show-toplevel 2>$null); if (-not $repo) { $repo = \"${workspaceFolder}\" }; if ([string]::IsNullOrWhiteSpace($repo)) { throw 'RepositoryPath is empty' }; & \"${workspaceFolder}/.github/actions/set-development-mode/Set_Development_Mode.ps1\" -RepositoryPath $repo }"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Revert Dev Mode (LabVIEW)",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-NoProfile",
        "-Command",
        "& { $ErrorActionPreference='Stop'; $repo = (git -C \"${workspaceFolder}\" rev-parse --show-toplevel 2>$null); if (-not $repo) { $repo = \"${workspaceFolder}\" }; if ([string]::IsNullOrWhiteSpace($repo)) { throw 'RepositoryPath is empty' }; & \"${workspaceFolder}/.github/actions/revert-development-mode/RevertDevelopmentMode.ps1\" -RepositoryPath $repo }"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    }
  ]
}
